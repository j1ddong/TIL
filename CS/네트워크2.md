# 네트워크

> 네트워크는 컴퓨터 등의 장치들이 통신 기술을 이용하여 구축하는  연결망을 지칭하는 용어



## 1. 네트워크 기초

- 용어 정리
  
  - 노드: 서버, 라우터, 스위치 등 네트워크 장치
  
  - 링크: 유선 또는 무선을 의미
  
  - 대역폭: 주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수

### 1.1 처리량과 지연시간

#### 처리량

> 링크를 통해 전달되는 단위 시간당 데이터양, bps(bits per second) 단위를 사용한다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/throughput.PNG" alt="" width="334" data-align="center">

- 처리량은 트래픽, 네트워크 장치 간 대역폭, 네트워크 중간에 발생하는 에러, 장치의 하드웨어 스펙에 영향받는다.

#### 지연 시간

> 요청이 처리되는 시간을 말하며, 어떤 메시지가 두 장치 사이를 왕복하는데 걸린 시간

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/latency.PNG" alt="" width="386" data-align="center">

- 매체 타입(유선, 무선), 패킷 크기, 라우터의 패킷 처리 시간에 영향받는다.



### 1.2 네트워크 토폴로지와 병목 현상

#### 네트워크 토폴로지

> 노드와 링크가 어떻게 배치되어 있는지에 대한 방식이자 연결 형태를 의미한다.

- 트리 토폴로지
  
  - 계층형 트폴로지이며 노드의 추가, 삭제가 쉽다.
  
  - 특정 노드에 트래픽이 집중될 때 하위 노드에 영향을 줄 수 있다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/treeTopology.PNG" alt="" width="394" data-align="center">

- 버스 토폴로지
  
  - 중앙 통신 회선 하나에 여러 개의 노드가 연결되어 공유하는 네트워크 구성
  
  - 근거리 통싱망(LAN)에서 사용된다.
  
  - 설치 비용이 적고, 신뢰성이 우수하다.
  
  - 노드를 추가하고 삭제하기 쉽다.
  
  - 스푸핑이 가능한 문제점이 있다.
    
    - 스푸핑: 스위칭(LAN상에서 송신부 패킷을 송신과 관련없는 다른 호스트에게 가지 않도록 하는 기능)을 마비시키거나 속여서 특정 노드에 해당 패킷이 오도록 처리하는 것

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/busTopology.PNG" title="" alt="" data-align="center">

- 스타 토폴로지
  
  - 노드를 추가하거나 에러를 탐지하기 쉽고 패킷의 충돌 발생 가능성이 적다.
  
  - 장애 노드가 중앙 노드가 아닐 경우, 다른 노드에 영향을 끼치는 것이 어렵다.
  
  - 중앙 노드에 장애가 발생할 경우, 전체 네트워크 사용이 불가능하다.
  
  - 설치 비용이 고가이다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/starTopology.PNG" alt="" data-align="center" width="371">

- 링형 토폴로지
  
  - 각각 노드가 양 옆의 두 노드와 연결하여 하나의 연속된 길을 통해 통신을 하는 망 구성 방식
  
  - 데이터는 노드에서 노드로 이동하며 각 노드는 고리 모양의 길을 통해 패킷을 처리한다.
  
  - 노드 수가 증가되어도 네트워크 손실이 거의 없고, 충돌이 발생할 가능성도 적다.
  
  - 노드 고장도 쉽게 발견할 수 있다.
  
  - 네트워크 구성 변경이 어렵고, 회선에 장애가 발생하면 전체 네트워크에 영향을 미친다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/ringTopology.PNG" alt="" data-align="center" width="367">

- 메시 토폴로지(망형 토폴로지)
  
  - 한 단말 장치에 장애가 발생해도 여러 개의 경로가 존재하므로 네트워크 사용이 가능하고, 분산 처리도 가능하다.
  
  - 노드 추가가 어렵고, 구축 비용과 운용 비용이 높다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/meshTopology.PNG" alt="" width="406" data-align="center">

### 1.3 네트워크 분류

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/network.PNG" title="" alt="" data-align="center">

### LAN

근거리 통신망을 의미하며 같은 건물이나 캠퍼스 같은 좁은 공간에서 운영된다. 전송 속도가 빠르고 혼잡하지 않다.

#### MAN

대도시 지역 네트워크를 나타내며 도시 같은 넓은 지역에서 운영된다. 전송 속도는 평균이며 LAN보다는 더 많이 혼잡하다.

#### WAN

광역 네트워크를 의미하며 국가 또는 대륙 같은 더 넓은 지역에서 운영된다. 전송 속도는 낮으며 MAN보다 더 혼잡하다.



네트워크 프로토콜이란 다른 장치들끼리 데이터를 주고받기 위해 설정된 공통된 인터페이스이다.



---



## 2. TCP/IP 4계층 모델

### 2. 1 계층 구조

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git hub/TIL/images/tcpIp.PNG" alt="" data-align="center" width="369"><img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/tcpIpFour.PNG" alt="" data-align="center" width="371">

- 특정 계층이 변경되었을 때 다른 계층이 영향을 받지 않도록 설계되어 있다.

#### 애플리케이션 계층

> FTP, HTTP, SSH, SMTP, DNS 등 응용 프로그램이 사용되는 프로토콜 계층이며 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층

- FTP: 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜

- SSH: 보안되지 않은 네트워크에서 네트워크 서비스를 안정하게 운영하기 위한 암호화 네트워크 프로토콜

- HTTP: World Wide Web을 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 데 쓰는 프로토콜

- SMTP: 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜

- DNS: 도메인 이름과 IP 주소를 매핑해주는 서버

#### 전송 계층

> 송신자와 수신자를 연결하는 통신 서비스를 제공한다.
> 
> 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어를 제공하며, 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때의 중계 역할을 한다.

- TCP: 패킷 사이의 순서를 보장하고 연결지향 프로토콜을 사용해서 연결을 한다.  쓰리웨이 핸드 쉐이크를 통해 신뢰성을 구축하여 수신 여부를 확인하며 **가상회선 패킷 교환 방식**을 사용한다.
  
  - 가상회선 패킷 교환 방식: 각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 순서대로 도착하는 방식을 말한다.

- TCP 연결 성립 과정
  
  - SYN: 클라이언트는 서버에 클라이언트 ISN(초기 네트워크 연결을 할 때 할당된 32비트 고유 시퀀스 번호)를 보낸다.
  
  - SYN + ACK: 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며 승인번호로 클라이언트 ISN + 1을 보낸다.
  
  - ACK: 클라이언트는 서버의 ISN + 1한 값인 승인번호를 담아 ACK를 서버에 보낸다.

- UDP: 순서를 보장하지 않고 수신 여부를 확인하지 않으며 단순히 데이터만 주는 **데이터그램 패킷 교환 방식**을 사용한다.
  
  - 데이터그램 패킷 교환 방식: 패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메세지에서 분할된 여러 패킷은 서로 다른 경로로 전솔될 수 있으며 순서가 다를 수 있는 방식을 뜻한다.

#### 인터넷 계층

> 장치로부터 받은 네트워크 패킷을  IP주소로 지정된 목적지로 전송하기 위해 사용되는 계층이다. IP, ARP, ICMP 등이 있으며 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달한다.

- 상대방이 제대로 받았는지에 대해 보장하지 않는 비연결형적인 특징을 가지고 있다.

#### 링크 계층

> 전선, 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 규칙을 정하는 계층이다. 

- 물리 계층과 데이터 링크 계층으로 나누기도 한다.

- 물리 계층은 무선 LAN과 유선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층이다.

- 데이터 링크 계층은 `이더넷 프레임`을 통해 에러 확인, 흐름 제어, 접근 제어를 담당하는 계층을 말한다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/ethernet.PNG" alt="" width="541" data-align="center">

전달받은 데이터의 에러를 검출하고 캡슐화하며 위와 같은 구조를 가진다.

- Preamble: 이더넷 프레임이 시작임을 알린다.

- SFD: 다음 바이트부터 MAC 주소 필드가 시작됨을 알린다.

- DMAC, SMAC: 수신, 송신 MAC 주소를 말한다.

- EtherType: 데이터 계층 위의 계층인 IP 프로토콜을 정의한다. 예) IPv4, IPv6

- Payload: 전달받은 데이터

- CRC: 에러 확인 비트



#### 계층 간 데이터 송수신 과정

> 애플리케이션 계층에서 전송 계층으로 요청값들이 캡슐화 과정을 거쳐 전달된다. 다시 링크 계층을 통해 해당 서버와 통신을 하고 해당 서버의 링크 계층으로부터 애플리케이션까지 비 캡슐화과정을 거쳐 데이터가 전송된다.

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/dataMove.PNG" title="" alt="" data-align="center">

### 2.2 PDU

> 네트워크 어떠한 계층에서 계층으로 데이터가 전달될 때 단위를 PDU(Protocol Data Unit)라고 한다.

- PDU는 제어 관련 정보들이 포함된 헤더, 데이터를 의미하는 페이로드로 구성되어 있으며 계층마다 부르는 명칭이 다르다.

- 애플리케이션 계층: 메세지

- 전송 계층: 세그먼트(TCP), 데이터그램(UDP)

- 인터넷 계층: 패킷

- 링크 계층: 프레임(데이터 링크 계층), 비트(물리 계층)



---



## 3. 네트워크 기기

### 3.1 처리 범위

애플리케이션 계층: L7 스위치

인터넷 계층: L3 스위치

데이터 링크 계층: 브리지, L2 스위치

물리 계층: NIC, 리피터, AP

#### L7 스위치

> 여러 장비를 연결하고 데이터 통신을 중재하며, 목적지가 연결된 포트로만 전기 신호를 보내 데이터를 전송하는 통신 네트워크 장비이다.

- 로드밸런서라고도 한다.

- 서버의 부하를 분산하는 기기로, 클라이언트로부터 오는 요청들을 여러 서버로 나누는 역할을 한다.

- 바이러스, 불필요한 외부 데이터 등을 걸러내는 필터링 기능도 있다.



---



## 4. IP 주소

#### ARP

> ARP(Address Resolution Protocol)란 IP주소로부터 MAC 주소를 구하는 IP와 MAC주소의 다리 역할을 하는 프로토콜이다.

컴퓨터와 컴퓨터 간의 통신은 IP주소가 아닌 MAC 주소를 기반으로 한다.

#### IP 주소 체계

1. IPv4
   
   32비트를 8비트 단위로 점을 찍어 표기한 것이다.

2. IPv6
   
   64비트를 16비트 단위로 점을 찍어 표기한 것이다.



---



## 5.  HTTP

### HTTP / 1.0

- 한 연결당 하나의 요청을 처리하도록 설계되어있다.

- 이로 인해 RTT(패킷이 목적지에 도달하고 나서 다시 출발지로 돌아오기까지 걸리는 시간)가 증가하게 되었다.

- RTT 증가를 해결하기 위해, 이미지 스플리팅, 코드 압축, 이미지 Base64인코딩을 사용했다.

### HTTP / 1.1

- 매번 TCP 연결을 하는 것이 아니라 한 번 TCP 초기화를 한 이후에 keep-alive라는 옵션으로 여러 개의 파일을 송수신할 수 있게 됐다.

<img title="" src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/httpCompare.PNG" alt="" width="438" data-align="center">

- HOL Blocking: 네트워크에서 같은 큐에 있는 패킷이 첫번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상을 말한다.

- 헤더에 쿠키 등 많은 메타데이터가 들어있고 압축이 되지 않아 무거웠다.

### HTTP / 2

- 멀티플렉싱, 헤더 압축, 서버 푸시, 요청의 우선순위 처리를 지원하는 프로토콜이다.

- 멀티플레싱: 여러 개의 스트림(데이터 흐름)을 사용하여 송수신을 말한다. 이를 통해 특정 스트림의 패킷이 손실되어도, 다른 스트림에는 영향을 미치지 않는다.

- 멀티플레싱으로, 단일 연결을 사용하여 병렬로 여러 요청을 보낼 수 있고 응답을 줄 수 있다.

- HTTP / 2는 클라이언트 요청 없이 서버가 바로 리소스를 푸시할 수 있다.

### HTTPS

> 애플리케이션 계층과 전송 계층 사이에 신뢰계층인 SSL/TLS 계층을 넣은 신뢰할 수 있는 HTTP 요청을 말한다.

#### SSL/TLS

전송계층에서 보안을 제공하는 프로토콜이다. 클라이언트와 서버가 통신할 때 SSL/TLS를 통해 제3자가 메시지를 도청하거나 변조하지 못하도록 한다.

#### HTTPS 구축 방법

1. CA에서 구매한 인증키를 기반으로 HTTPS 서비스 구축

2. 서버 앞단에 HTTPS를 제공하는 로드밸런스 두기

3. 서버 앞단에 HTTPS를 제공하는 CDN을 둬서 구축

### HTTP / 3

- TCP 위에서 돌아가는 HTTP/2와 달리 HTTP/3은 QUIC이라는 계층 위에서 돌아가며, TCP기반이 아닌 UDP기반으로 돌아간다

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/httpCompare2.PNG" title="" alt="" data-align="center">

- QUIC는 TCP를 사용하지 않기 때문에 통신을 시작할 때 쓰리웨이 핸드쉐이크 과정을 거치지 않아도 된다
