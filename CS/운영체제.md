# 운영체제

## 운영체제 역할과 구조

### 역할

1. CPU 스케쥴링과 프로세스 관리
   
   - CPU 소유권을 어떤 프로세스에 할당할지, 프로세스의 생성과 삭제, 자원 할당 및 반환을 관리한다.

2. 메모리 관리
   
   - 한정된 메모리를 어떤 프로세스에 얼만큼 할당해야 하는지 관리한다.

3. 디스크 파일 관리
   
   - 디스크 파일을 어떠한 방법으로 보관할지 관리한다.

4. I/O 디바이스 관리
   
   - I/O 디바이스들인 마우스, 키보드와 컴퓨터 간에 데이터를 주고받는 것을 관리한다.

### 운영체제 구조

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/osStructure.PNG" title="" alt="" data-align="center">

- 드라이버 - 하드웨어를 제어하기 위한 소프트웨어

- 커널 - 시스템콜 인터페이스를 제공하며 보안, 메모리, 프로세스, 파일 시스템, I/O 디바이스, I/O 요청 관리 등 운영체제의 중추적인 역할을 한다.

#### 시스템 콜

> 운영체제가 커널에 접근하기 위한 인터페이스이며, 유저 프로그램이 운영체제의 서비스를 받기 위해 커널 함수를 호출할 때 쓰인다.

- modebit
  
  - 시스템콜이 작동될 때 modebit을 참고해서 유저모드와 커널모드를 구분한다.
  
  - 1또는 0의 값을 가지는 플래그 변수이다.
  
  - 0은 커널모드 1은 유저모드이다.



---

## 컴퓨터 요소

![](C:\Users\jiunHan\Desktop\Git%20hub\TIL\images\computer.PNG)

### CPU

> 산술논리연산장치, 제어장치, 레지스터로 구성되어 있는 컴푸터 장치
> 
> 인터럽트에 의해 메모리에 존재하는 명령어를 해석해서 실행하는 일꾼

- 제어장치: 프로세스 조작을 지시하는 부품, 입출력장치간 통신을 제어하고 명령어를 읽고 해석하며 데이터 처리를 위한 순서 결정

- 레지스터: CPU 내부에 매우 빠른 임시기억장치, CPU는 자체적으로 데이터를 저장할 방법이 없기 때문에 레지스터를 거쳐 데이터 전달

- 산술논리연산장치: 산술 연산과 논리 연산을 계산하는 디지털 회로다

### DMA 컨트롤러

> I/O 디바이스가 메모리에 직접 전급할 수 있도록 하는 하드웨어 장치

- CPU에 너무 많은 인터럽트 요청이 들어오면 일을 나눠해주는 보조 일꾼

### 메모리

> 전자회로에서 데이터나 상태, 명령어 등을 기록하는 장치

### 타이머

- 몇 초 안에는 작업이 끝나야 한다는 것을 정하고 특정 프로그램에 시간 제한다는 역할

- 시간이 많이 걸리는 프로그램이 작동할 때 제한을 걸기 위해 존재

### 디바이스 컨트롤러

- 컴퓨터와 연결되어 있는 I/O 디바이스들의 작은 CPU



----

## 메모리

#### 메모리 계층

- 레지스터: CPU 안에 있는 작은 메모리, 휘발성이고 메모리 중 속도 가장 빠르지만 기억 용량이 제일 적다.

- 캐시: L1, L2캐시를 지칭한다. 휘발성이고 속도가 빠르지만 기억 용량이 적다.

- 주기억장치: RAM을 가리키며 휘발성이다. 

- 보조기억장치: HDD, SSD, 비휘발성

#### 캐시

> 데이터를 미리 복사해 놓은 임시저장소이자, 빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리이다.



### 메모리 관리

#### 가상 메모리

> 컴퓨터가 실제로 이용 가능한 메모리 자원을 추상화하여 이를 사용하는 사용자들에게 매우 큰 메모리를 보이게 만드는 기법

- 가상 주소는 메모리관리장치(MMU)에 의해 실제 주소로 변환된다.

- 가상 메모리는 가상 주소와 실제 주소가 매핑되어 있고 프로세스 주소 정보가 들어 있는 페이지 테이블로 관리된다.

#### 용어 정리

1. 페이지 폴트
   
   프로세스 주소 공간에는 존재하지만 컴퓨터 RAM에는 없는 데이터에 접근했을 경우 발생한다.

2. 스와핑
   
   사용하지 않는 영역을 하드디스크로 옮겨 필요할 때 다시 RAM으로 불러와 올리고, 사용하지 않으면 다시 하드디스크로 내림을 반복하여 RAM을 효과적으로 관리하는 것을 스와핑이라고 한다.



---

## 프로세스와 스레드

> 프로세스는 컴퓨터에서 실행되고 있는 프로그램을 말하며, CPU 스케쥴링의 대상이 되는 작업이라는 용어와 비슷하게 쓰인다. 스레드는 프로세스 내 작업의 흐름을 지징한다.



### 프로세스

#### 프로세스 메모리 구조

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/memory_structure.PNG" title="" alt="" data-align="center">

##### 스택

- 지역변수, 매개변수, 함수가 저장된다.

- 컴파일 시 크기가 결정되는 동적인 특징을 갖는다.

##### 힙

- 벡터 같은 동적 배열을 할당할 때 사용되며, 런타임 시 크기가 결정된다.

##### 데이터 영역

- 전역변수, 정적 변수가 저장되고 정적인 특징을 갖는 프로그램이 종료되면 사라지는 변수가 들어있는 영역이다.

- 데이터 영역은 BSS 영역과 Data 영역으로 나뉘고, BSS 영역은 초기화되지 않은 변수가 0으로 초기화되어 저장되며 Data 영역은 0이 아닌 다른 값으로 할당된 변수들이 저장된다.

##### 코드 영역

- 코드 영역은 프로그램에 내장되어 있는 소스 코드가 들어가는 영역이다. 

- 수정 불가능한 기계어로 저장되어 있으며 정적이다.



#### PCB(Process Control Block)

> 운영체제에서 프로세스에 대한 메타데이터를 저장한 데이터를 말한다.

- 프로세스가 생성되면 운영체제는 해당 PCB를 생성한다.

- 프로그램이 실행되면 프로세스가 생성되고 프로세스 주소 값들이 스택, 힙 등 구조를 기반으로 메모리가 할당된다.

##### 컨텍스트 스위칭

- PCB를 교환하는 과정을 말한다.

- 한 프로세스에 할당된 시간이 끝나거나 인터럽트에 의해 발생한다.



#### 멀티프로세싱

> 멀티프로세싱은 여러 개의 프로세스 즉 멀티 프로세스를 통해 동시에 두 가지 이상의 일을 수행할 수 있는 것을 말합니다. 

- 하나 이상의 일을 병렬로 처리할 수 있으며 특정 프로세스의 메모리, 프로세스 중 일부에 문제가 발생되더라도 다른 프로세스를 이용해서 처리할 수 있으므로 신뢰성이 높다.

### 스레드

> 프로세스 실행 가능한 가장 작은 단위이고 프로세는 여러 스레드를 가질 수 있다.

<img src="file:///C:/Users/jiunHan/Desktop/Git%20hub/TIL/images/thread.PNG" title="" alt="" data-align="center">

- 코드, 데이터, 스택, 힙을 각각 생성하는 프로세스와는 다르게 스레드는 코드, 데이터, 힙을 공유한다.

#### 멀티스레딩

> 프로세스 내 작업을 여러 개의 스레드, 멀티스레드로 처리하는 기법이며 스레드끼리 서로 자원을 공유하기 때문에 효율성이 높다

- 한 스레드에 문제가 생기면 다른 스레드에도 영향을 끼쳐 스레드로 이루어져 있는 프로세스에 영향을 줄 수 있다는 단점이 있다.
